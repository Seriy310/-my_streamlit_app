import streamlit as st

# –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–∏
st.title("–ê–Ω–∞–ª—ñ–∑ —ñ–Ω–≤–µ—Å—Ç–∏—Ü—ñ—ó —Ç–∞ –∫—Ä–µ–¥–∏—Ç—É üí∞")

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏–±–æ—Ä—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏
page = st.selectbox("–í–∏–±–µ—Ä—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É", ["–û—Å–Ω–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞", "–û–±–ª—ñ–∫ —Å–ø–ª–∞—Ç–∏ –∫—Ä–µ–¥–∏—Ç—É"])

if page == "–û—Å–Ω–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞":
    # –í–≤—ñ–¥ –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º
    credit_enabled = st.checkbox("–í–∫–ª—é—á–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫—Ä–µ–¥–∏—Ç?", value=True)

    if credit_enabled:
        credit_amount = st.number_input("–°—É–º–∞ –∫—Ä–µ–¥–∏—Ç—É (–∑–ª–æ—Ç–∏—Ö):", min_value=0.0, step=100.0, value=27000.0)
        loan_term_months = st.number_input("–¢–µ—Ä–º—ñ–Ω –∫—Ä–µ–¥–∏—Ç—É (–º—ñ—Å—è—Ü—ñ–≤):", min_value=1, step=1, value=48)
        monthly_payment_loan = st.number_input("–©–æ–º—ñ—Å—è—á–Ω–∏–π –ø–ª–∞—Ç—ñ–∂ –ø–æ –∫—Ä–µ–¥–∏—Ç—É (–∑–ª–æ—Ç–∏—Ö):", min_value=0.0, step=50.0, value=669.21)
        monthly_insurance = st.number_input("–©–æ–º—ñ—Å—è—á–Ω–∞ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ (–∑–ª–æ—Ç–∏—Ö):", min_value=0.0, step=10.0, value=114.48)

    # –Ü–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, —â–æ –Ω–µ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ –≤–∏–±–æ—Ä—É –ø—Ä–æ –∫—Ä–µ–¥–∏—Ç
    royalty_percent = st.number_input("–ü—Ä–æ—Ü–µ–Ω—Ç —Ä–æ—è–ª—Ç—ñ —Ñ—Ä–∞–Ω—á–∞–π–∑–µ—Ä—É (%):", min_value=0.0, max_value=100.0, step=1.0, value=7.0)
    monthly_income = st.number_input("–©–æ–º—ñ—Å—è—á–Ω–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ —ñ–Ω–≤–µ—Å—Ç–∏—Ü—ñ—ó (–∑–ª–æ—Ç–∏—Ö):", min_value=0.0, step=100.0, value=1500.0)

    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
    if st.button("–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏", use_container_width=True):
        try:
            # –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤
            royalty_decimal = royalty_percent / 100  # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ —É –¥–µ—Å—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ
            if credit_enabled:
                # –ó–∞–≥–∞–ª—å–Ω—ñ —â–æ–º—ñ—Å—è—á–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏, —è–∫—â–æ –∫—Ä–µ–¥–∏—Ç –∞–∫—Ç–∏–≤–Ω–∏–π
                monthly_total_payment = monthly_payment_loan + monthly_insurance  # –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç—É
                total_payment_over_loan_term = monthly_total_payment * loan_term_months  # –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –≤–∏–ø–ª–∞—Ç
                overpayment = total_payment_over_loan_term - credit_amount  # –ü–µ—Ä–µ–ø–ª–∞—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç—É
            else:
                # –Ø–∫—â–æ –∫—Ä–µ–¥–∏—Ç –≤—ñ–¥–∫–ª—é—á–µ–Ω–æ, –ª–∏—à–µ —Ä–∞—Ö—É—î–º–æ —Ä–æ—è–ª—Ç—ñ —Ç–∞ –¥–æ—Ö—ñ–¥
                overpayment = 0
                monthly_total_payment = 0  # –ë–µ–∑ –∫—Ä–µ–¥–∏—Ç—É
                total_payment_over_loan_term = 0

            royalty_payment = monthly_income * royalty_decimal  # –©–æ–º—ñ—Å—è—á–Ω–µ —Ä–æ—è–ª—Ç—ñ
            net_profit = monthly_income - monthly_total_payment - royalty_payment  # –ß–∏—Å—Ç–∏–π –ø—Ä–∏–±—É—Ç–æ–∫
            time_to_coverage_overpayment = overpayment / net_profit if net_profit > 0 else float('inf')  # –ß–∞—Å –æ–∫—É–ø–Ω–æ—Å—Ç—ñ

            # –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∑ –ø–æ–∫—Ä–∞—â–µ–Ω–∏–º –¥–∏–∑–∞–π–Ω–æ–º
            st.subheader("üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É:")
            if credit_enabled:
                st.markdown(f"‚úÖ **–ó–∞–≥–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–ø–ª–∞—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç—É:** {overpayment:.2f} –∑–ª–æ—Ç–∏—Ö", unsafe_allow_html=True)
                st.markdown(f"üí∞ **–©–æ–º—ñ—Å—è—á–Ω–µ —Ä–æ—è–ª—Ç—ñ —Ñ—Ä–∞–Ω—á–∞–π–∑–µ—Ä—É:** {royalty_payment:.2f} –∑–ª–æ—Ç–∏—Ö", unsafe_allow_html=True)
                st.markdown(f"üìà **–ß–∏—Å—Ç–∏–π –ø—Ä–∏–±—É—Ç–æ–∫ –Ω–∞ –º—ñ—Å—è—Ü—å:** {net_profit:.2f} –∑–ª–æ—Ç–∏—Ö", unsafe_allow_html=True)
                st.markdown(f"‚åõ **–ß–∞—Å –¥–ª—è –ø–æ–∫—Ä–∏—Ç—Ç—è –ø–µ—Ä–µ–ø–ª–∞—Ç–∏:** {time_to_coverage_overpayment:.2f} –º—ñ—Å—è—Ü—ñ–≤", unsafe_allow_html=True)
            else:
                st.markdown(f"üí∞ **–©–æ–º—ñ—Å—è—á–Ω–µ —Ä–æ—è–ª—Ç—ñ —Ñ—Ä–∞–Ω—á–∞–π–∑–µ—Ä—É:** {royalty_payment:.2f} –∑–ª–æ—Ç–∏—Ö", unsafe_allow_html=True)
                st.markdown(f"üìà **–ß–∏—Å—Ç–∏–π –ø—Ä–∏–±—É—Ç–æ–∫ –Ω–∞ –º—ñ—Å—è—Ü—å (–±–µ–∑ –∫—Ä–µ–¥–∏—Ç—É):** {net_profit:.2f} –∑–ª–æ—Ç–∏—Ö", unsafe_allow_html=True)

            # –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—ñ–¥—Å–≤—ñ—Ç–∫–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–ª—å–æ—Ä—ñ–≤
            if net_profit > 0:
                st.success("üëç –í–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ —á–∏—Å—Ç–∏–π –ø—Ä–∏–±—É—Ç–æ–∫ —â–æ–º—ñ—Å—è—Ü—è!")
            else:
                st.error("‚ö†Ô∏è –í–∏ –Ω–µ –æ—Ç—Ä–∏–º—É—î—Ç–µ –ø—Ä–∏–±—É—Ç–æ–∫, —ñ –≤–∞—à—ñ –≤–∏—Ç—Ä–∞—Ç–∏ –ø–µ—Ä–µ–≤–∏—â—É—é—Ç—å –¥–æ—Ö–æ–¥–∏.")
        
        except ValueError:
            st.error("–ü–æ–º–∏–ª–∫–∞! –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ —á–∏—Å–ª–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.")
    
elif page == "–û–±–ª—ñ–∫ —Å–ø–ª–∞—Ç–∏ –∫—Ä–µ–¥–∏—Ç—É":
    st.subheader("–û–±–ª—ñ–∫ —Å–ø–ª–∞—Ç–∏ –∫—Ä–µ–¥–∏—Ç—É")

    # –í–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è –æ–±–ª—ñ–∫—É –∫—Ä–µ–¥–∏—Ç—É
    loan_balance = st.number_input("–ü–æ—á–∞—Ç–∫–æ–≤–∏–π –±–∞–ª–∞–Ω—Å –∫—Ä–µ–¥–∏—Ç—É (–∑–ª–æ—Ç–∏—Ö):", min_value=0.0, step=100.0, value=27000.0)
    monthly_payment = st.number_input("–©–æ–º—ñ—Å—è—á–Ω–∏–π –ø–ª–∞—Ç—ñ–∂ –ø–æ –∫—Ä–µ–¥–∏—Ç—É:", min_value=0.0, step=50.0, value=669.21)
    
    # –í–µ–¥–µ–Ω–Ω—è –æ–±–ª—ñ–∫—É —Å–ø–ª–∞—Ç–∏
    months_paid = st.number_input("–ö—ñ–ª—å–∫—ñ—Å—Ç—å –º—ñ—Å—è—Ü—ñ–≤, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–∏—Ö –≤–∂–µ —Å–ø–ª–∞—á–µ–Ω–æ –∫—Ä–µ–¥–∏—Ç:", min_value=0, step=1, value=0)
    current_balance = loan_balance - (monthly_payment * months_paid)
    
    st.write(f"**–ó–∞–ª–∏—à–æ–∫ –ø–æ –∫—Ä–µ–¥–∏—Ç—É –ø—ñ—Å–ª—è —Å–ø–ª–∞—Ç–∏:** {current_balance:.2f} –∑–ª–æ—Ç–∏—Ö")
    
    # –î–æ–¥–∞–≤–∞–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞–Ω—ñ (–ø—Å–µ–≤–¥–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–ª—è –ø—Ä–∏–∫–ª–∞–¥—É)
    st.write("–¶–µ –ø—Ä–æ—Å—Ç–∏–π –æ–±–ª—ñ–∫, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞–Ω—ñ, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö –∞–±–æ CSV —Ñ–∞–π–ª.")
